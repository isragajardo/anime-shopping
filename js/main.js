const productos= [
    {
        id : "abrigo-01",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-abrigos/naruto-abrigo-01.png",
        categoria : {
            nombre: "Abrigos Naruto",
            id : "abrigos"
        },
        precio : 1000
    },
    {
        id : "abrigo-02",
        titulo : "Hinata",
        imagen : "./img/naruto/naruto-abrigos/naruto-abrigo-02.png",
        categoria : {
            nombre: "Abrigos Naruto",
            id : "abrigos"
        },
        precio : 1000
    },
    {
        id : "abrigo-03",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-abrigos/naruto-abrigo-03.png",
        categoria : {
            nombre: "Abrigos Naruto",
            id : "abrigos"
        },
        precio : 1000
    },
    {
        id : "abrigo-04",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-abrigos/naruto-abrigo-04.png",
        categoria : {
            nombre: "Abrigos Naruto",
            id : "abrigos"
        },
        precio : 1000
    },
    {
        id : "abrigo-05",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-abrigos/naruto-abrigo-05.png",
        categoria : {
            nombre: "Abrigos Naruto",
            id : "abrigos"
        },
        precio : 1000
    },
    {
        id : "abrigo-06",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-abrigos/naruto-abrigo-06.png",
        categoria : {
            nombre: "Abrigos Naruto",
            id : "abrigos"
        },
        precio : 1000
    },
    {
        id : "abrigo-06",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-abrigos/naruto-abrigo-07.png",
        categoria : {
            nombre: "Abrigos Naruto",
            id : "abrigos"
        },
        precio : 1000
    },
    {
        id : "abrigo-06",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-abrigos/naruto-abrigo-08.png",
        categoria : {
            nombre: "Abrigos Naruto",
            id : "abrigos"
        },
        precio : 1000
    },
    /**   pantalones **/
    {
        id : "pantalon-01",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-pantalones/naruto-pantalon-01.png",
        categoria : {
            nombre: "Pantalones Naruto",
            id : "pantalones"
        },
        precio : 1000
    },
    {
        id : "pantalon-02",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-pantalones/naruto-pantalon-02.png",
        categoria : {
            nombre: "Pantalones Naruto",
            id : "pantalones"
        },
        precio : 1000
    },
    {
        id : "pantalon-03",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-pantalones/naruto-pantalon-03.png",
        categoria : {
            nombre: "Pantalones Naruto",
            id : "pantalones"
        },
        precio : 1000
    },
    {
        id : "pantalon-04",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-pantalones/naruto-pantalon-04.png",
        categoria : {
            nombre: "Pantalones Naruto",
            id : "pantalones"
        },
        precio : 1000
    },
    {
        id : "pantalon-05",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-pantalones/naruto-pantalon-05.png",
        categoria : {
            nombre: "Pantalones Naruto",
            id : "pantalones"
        },
        precio : 1000
    },
    {
        id : "pantalon-06",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-pantalones/naruto-pantalon-06.png",
        categoria : {
            nombre: "Pantalones Naruto",
            id : "pantalones"
        },
        precio : 1000
    },
    {
        id : "pantalon-07",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-pantalones/naruto-pantalon-07.png",
        categoria : {
            nombre: "Pantalones Naruto",
            id : "pantalones"
        },
        precio : 1000
    },
    {
        id : "pantalon-08",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-pantalones/naruto-pantalon-08.png",
        categoria : {
            nombre: "Pantalones Naruto",
            id : "pantalones"
        },
        precio : 1000
    },
    /*****camisetas****/
    {
        id : "camiseta-01",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-camisetas/naruto-camiseta-01.png",
        categoria : {
            nombre: "Camisetas Naruto",
            id : "camisetas"
        },
        precio : 1000
    },
    {
        id : "camiseta-02",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-camisetas/naruto-camiseta-02.png",
        categoria : {
            nombre: "Camisetas Naruto",
            id : "camisetas"
        },
        precio : 1000
    },
    {
        id : "camiseta-03",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-camisetas/naruto-camiseta-03.png",
        categoria : {
            nombre: "Camisetas Naruto",
            id : "camisetas"
        },
        precio : 1000
    },
    {
        id : "camiseta-04",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-camisetas/naruto-camiseta-04.png",
        categoria : {
            nombre: "Camisetas Naruto",
            id : "camisetas"
        },
        precio : 1000
    },
    {
        id : "camiseta-05",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-camisetas/naruto-camiseta-05.png",
        categoria : {
            nombre: "Camisetas Naruto",
            id : "camisetas"
        },
        precio : 1000
    },
    {
        id : "camiseta-06",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-camisetas/naruto-camiseta-06.png",
        categoria : {
            nombre: "Camisetas Naruto",
            id : "camisetas"
        },
        precio : 1000
    },
    {
        id : "camiseta-07",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-camisetas/naruto-camiseta-07.png",
        categoria : {
            nombre: "Camisetas Naruto",
            id : "camisetas"
        },
        precio : 1000
    },
    {
        id : "camiseta-08",
        titulo : "Naruto",
        imagen : "./img/naruto/naruto-camisetas/naruto-camiseta-08.png",
        categoria : {
            nombre: "Camisetas Naruto",
            id : "camisetas"
        },
        precio : 1000
    }
]

const contenedorProductos = document.querySelector("#contenedor-productos");
const btnCategorias = document.querySelectorAll(".btn-categoria");
const tituloPrincipal = document.querySelector("#titulo-principal");
let btnAgregarCarrito
const numeroCarrito = document.querySelector("#numero-carrito");

let productosEnCarrito = []

const productosEnCarritoJson = localStorage.getItem("productos-en-carrito");
if(productosEnCarritoJson)
{
    
    productosEnCarrito = JSON.parse(productosEnCarritoJson);
    actualizarNumeroCarrito()
}else{
    productosEnCarrito = []
}

function cargarProductos(ProductoSeleccionado)
{
    contenedorProductos.innerHTML ="";
    
    ProductoSeleccionado.forEach(producto => {

        const div = document.createElement("div");
        div.classList.add("producto");
        div.innerHTML =   `
           <img class="producto-imagen" src="${producto.imagen}" alt=${producto.titulo}>                   <div class="producto-detalles">
           <div class="producto-detalles">
               <h3 class="producto-titulo">${producto.titulo}</h3>
               <p class="producto-precio">${producto.precio}</p>
               <button class="producto-agregar" id ="${producto.id}">Agregar</button>
           </div>
           </div>

        `
        console.log(producto.id)
        contenedorProductos.appendChild(div)
        actualizarBotonesAgregar();


    })

}
cargarProductos(productos)


btnCategorias.forEach(boton => {
   
    boton.addEventListener("click", (addActiveClass) =>{

        tituloPrincipal.innerText = "";

        btnCategorias.forEach(boton => boton.classList.remove("active"))

        addActiveClass.currentTarget.classList.add("active");

        if(addActiveClass.currentTarget.id != "todos")
        {
            
            const productosBoton = productos.filter( producto => producto.categoria.id === addActiveClass.currentTarget.id)
        
            cargarProductos(productosBoton)
            const categoriaSeleccionada = productos.find (producto => producto.categoria.id === addActiveClass.currentTarget.id)
             
            tituloPrincipal.innerText = categoriaSeleccionada.categoria.nombre

        }
        else
        {
            cargarProductos(productos)
            tituloPrincipal.innerText = "Todos los Productos"

        }

    })
});



function actualizarBotonesAgregar () {
    
    btnAgregarCarrito = document.querySelectorAll(".producto-agregar")
    console.log("test")

    btnAgregarCarrito.forEach(boton =>{
        boton.addEventListener("click", agregarAlCarrito);
    });
}



function agregarAlCarrito(valor){
    const idBoton = valor.currentTarget.id;
    const productoAgregado = productos.find(producto => producto.id  === idBoton)


    if(productosEnCarrito.some(producto => producto.id === idBoton))
    {
        const index = productosEnCarrito.findIndex(producto =>producto.id === idBoton);
        productosEnCarrito[index].cantidad++;
       



    }else
    {
        productoAgregado.cantidad = 1;
        productosEnCarrito.push(productoAgregado)


        
    }
    actualizarNumeroCarrito();

    localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito))

    
}
function actualizarNumeroCarrito(){
    let nuevoNumero = productosEnCarrito.reduce((acumulador, producto) => acumulador + producto.cantidad,0)
    console.log(nuevoNumero)
    numeroCarrito.innerText = nuevoNumero
}


